# 面试题 http

[Toc]
![img](../../../ToDo/media/16790366321650/16791273621977.jpg)

## 跨域

1. 同源策略:协议, 域名/Ip, 端口不一致
2. 解决办法:
    1. [jsonp](../JavaScript/jsonp.md)
        1. csrf攻击
            1. 验证JSONP的调用来源（Referer），服务端判断Referer是否是白名单，或者部署随机Token来防御。
        2. xss 漏洞
    2. [core](../Node/core.md)
    3. [Nginx 反向代理服务器](../Node/Nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8.md)

## 状态码

1. 状态码分类
    * 1xx - 服务器收到请求,表示目前是协议处理的中间状态，还需要后续操作。
    * 2xx - 请求成功，如 200。
    * 3xx - 重定向，如 302。
    * 4xx - 客户端错误，如 404。
    * 5xx - 服务端错误，如 500。

2. 常见状态码

    * **200 OK** - 成功。
    * **301 Moved Permanently** - 永久重定向（配合 location，浏览器自动处理）。
    * **302 Found** - 临时重定向（配合 location，浏览器自动处理）。
    * **304 Not Modified** - 协商缓存,资源未被修改。
    * **400 Bad Request**: 客户端错误.
    * **403 Forbidden**: 服务器禁止访问，原因有很多，比如法律禁止、信息敏感。
    * **404 Not Found**: 资源未找到，表示没在服务器上找到相应的资源。
    * **405 Method Not Allowed**: 请求方法不被服务器端允许。
    * **500 Internal Server Error**: 服务端错误
    * **501 Not Implemented**: 表示客户端请求的功能还不支持。
    * **502 Bad Gateway**: 服务器自身是正常的，但访问的时候出错了，啥错误咱也不知道。
    * **503 Service Unavailable**: 表示服务器当前很忙，暂时无法响应服务。
    * **504** - 网关超时。

3. 关于协议和规范

* 状态码都是约定出来的。
* 要求大家都跟着执行。
* 不要违反规范，例如 IE 浏览器。

[缓存](缓存.md)

## GET 和 POST 的区别

* 从缓存的角度，GET 请求会被浏览器主动缓存下来，留下历史记录，而 POST 默认不会。
* 从编码的角度，GET 只能进行 URL 编码，只能接收 ASCII 字符，而 POST 没有限制。
* 从参数的角度，GET 一般放在 URL 中，因此不安全，POST 放在请求体中，更适合传输敏感信息。
* 从幂等性的角度，GET 是幂等的，而 POST 不是。(幂等表示执行相同的操作，结果也是相同的)
* 从 TCP 的角度，GET 请求会把请求报文一次性发出去，而 POST 会分为两个 TCP 数据包，首先发 header 部分，如果服务器响应 100(continue)， 然后发 body 部分。(火狐浏览器除外，它的 POST 请求只发一个 TCP 包)

## HTTP/2 有哪些改进？

* 头部压缩。
* 多路复用。
* 服务器推送。

## HTTP 报文结构

起始行 + 头部 + 空行 + 实体
请求头
![img](../../../ToDo/media/16790366321650/16791274408658.jpg)

响应头
![img](../../../ToDo/media/16790366321650/16791274495509.jpg)

## HTTP 的请求方法

http/1.1规定了以下请求方法(注意，都是大写):

* GET: 通常用来获取资源
* POST: 提交数据，即上传数据
* PUT: 修改数据
* DELETE: 删除资源(几乎用不到)
* HEAD: 获取资源的元信息
* CONNECT: 建立连接隧道，用于代理服务器
* OPTIONS: 列出可对资源实行的请求方法，用来跨域请求
* TRACE: 追踪请求-响应的传输路径

## URI

统一资源标识符,区分互联网上不同的资源。

1. URI 真正最完整的结构
    ![img](../../../ToDo/media/16790366321650/16791277502593.jpg)

    * scheme 表示协议名，比如http, https, file等等。后面必须和://连在一起。
    * user:passwd@ 表示登录主机时的用户信息，不过很不安全，不推荐使用，也不常用。
    * host:port表示主机名和端口。
    * path表示请求路径，标记资源所在位置。
    * query表示查询参数，为key=val这种形式，多个键值对之间用&隔开。
    * fragment表示 URI 所定位的资源内的一个锚点，浏览器可以根据这个锚点跳转到对应的位置。

2. URI 编码
URI 只能使用ASCII,非 ASCII 码字符和界定符转为十六进制字节值，然后在前面加个%

## http 特点

* 灵活可扩展:
  * 语义自由，只规定了基本格式，比如空格分隔单词，换行分隔字段，其他的各个部分都没有严格的语法限制
  * 传输形式多样，不仅仅可以传输文本，还能传输图片、视频等任意数据，非常方便。
* 可靠传输。HTTP 基于 TCP/IP，继承了 TCP 的特性。
* 请求-应答。也就是**一发一收**、**有来有回**。
* 无状态。每次 http 请求都是独立、无关的，默认不需要保留状态信息。

## http 缺点

1. 无状态
    在长连接的场景中，需要保存大量的上下文信息，以免传输大量重复的信息，那么这时候无状态就是http 的缺点了。
2. 明文传输
    即协议里的报文(主要指的是头部)不使用二进制数据，而是文本形式。
3. 队头阻塞问题
    当 http 开启长连接时，共用一个 TCP 连接，同一时刻只能处理一个请求，那么当前请求耗时过长的情况下，其它的请求只能处于阻塞状态。
