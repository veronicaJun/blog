# 类型转换

- JavaScript 中的隐式类型转换是指在运行时，JavaScript 引擎会自动将一个数据类型转换为另一个数据类型，这种转换是由 JavaScript 引擎自动完成的，不需要我们手动操作。

- 原始值转换
    - Date() 字符串、数组转换为日期
    - 运算符 `+`、`-`、`*`、`/`、`==`、`>`、`<`、
        - 这些运算符只能操作基本类型值，所以在运算前先用ToPrimitive转换成基本类型，再进行操作。
        - 隐式转换的规则
            - `+`
                - 两边至少有一个 string 时，两边的变量都会被隐式转换为字符串
                - 其他情况下两边的变量都会被转换为数字
            - `-`、`*`、`/`
                - 如果两边的值都是数字，则进行相应的运算
                - 如果两边的值有一个不是数字，则将两边的值都转换为数字，再进行相应的运算
            - `==`、`>`、`<`
                - 如果两边的值类型相同，则直接进行比较
                - 如果两边的值类型不同，则将两边的值都转换为数字，再进行比较
            - `===`
                - 如果两边的值类型相同，则直接进行比较
                - 如果两边的值类型不同，则直接返回 false
            - `!!`
                - 将值转换为布尔值
        - ToPrimitive(obj,type)
            - JavaScript 中每个值隐含的自带的方法，用来将值 （无论是基本类型值还是对象）转换为基本类型值。
            - 参数
                - obj 需要转换的对象
                - type 期望的结果类型
            - 逻辑
                - 如果obj值为基本类型，则直接返回值本身
                - 如果obj值为对象
                    - 当type为number时
                        - 调用obj的valueOf方法，如果为原始值，则返回，否则下一步；
                        - 调用obj的toString方法，如果为原始值，则返回，否则下一步；
                        - 抛出TypeError 异常。
                    - 当type为string时
                        - 调用obj的toString方法，如果为原始值，则返回，否则下一步；
                        - 调用obj的valueOf方法，如果为原始值，则返回，否则下一步；
                        - 抛出TypeError 异常。

- 转换到 boolean 值
    - 以下这些是假值：
        - undefined
        - null
        - false
        - +0. -0 和 NaN
        - ""
    - 假值的布尔强制类型转换结果为 false。从逻辑上说，假值列表以外的都应该是真值。

- 转换到 number
    - Undefined 转换为 NaN。
    - Null 转换为 0。
    - Boolean ，true 转换为 1，false 转换为 0。
    - String 转换，如果包含非数字值则转换为 NaN，空字符串为 0。
    - Symbol 不能转换为数字，会报错。
    - 对象（包括数组）会首先被转换为相应的基本类型值，如果返回的是非数字的基本类型值，则再遵循以上规则将其强制转换为数字。
        - ToPrimitive 会首先检查该值是否有valueOf()方法
        - 如果有并且返回基本类型值，就使用该值进行强制类型转换
        - 如果没有就使用 toString() 的返回值（如果存在）来进行强制类型转换。
        - 如果 valueOf() 和 toString() 均不返回基本类型值，会产生 TypeError 错误。

- 转换到 string
    - Null 和 Undefined 类型 ，null 转换为 "null"，undefined 转换为 "undefined"，
    - Boolean 类型，true 转换为 "true"，false 转换为 "false"。
    - Number 直接转换，不过那些极小和极大的数字会使用指数形式。
    - Symbol 直接转换，但是只允许显式强制类型转换，使用隐式强制类型转换会产生错误。
    - 对象
        - 对普通对象来说，如果对象有自己的 toString() 方法，字符串化时就会调用该方法并使用其返回值
        - 否则会调用（Object.prototype.toString()）来返回内部属性的值，如"[object Object]"。
